# æ±ºæ¸ˆã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

**ä½œæˆæ—¥**: 2025-06-20  
**ä½œæˆè€…**: ãƒãƒ¼ãƒ Aï¼ˆèª²é‡‘ãƒ»æ±ºæ¸ˆæ‹…å½“ï¼‰  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**å¯¾è±¡**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…ã€ã‚µãƒãƒ¼ãƒˆæ‹…å½“è€…

---

## ğŸ“‹ æ¦‚è¦

AIè£œåŠ©é‡‘ç”³è«‹ã‚·ã‚¹ãƒ†ãƒ ã®æ±ºæ¸ˆãƒ—ãƒ­ã‚»ã‚¹ã§ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨ã€ãã®å¯¾å‡¦æ³•ã‚’ä½“ç³»åŒ–ã—ãŸãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®è¦³ç‚¹ã‹ã‚‰ã€åˆ†ã‹ã‚Šã‚„ã™ãè¦ªåˆ‡ãªæ¡ˆå†…ã‚’å¿ƒãŒã‘ã¦ã„ã¾ã™ã€‚

---

## ğŸ”„ ãƒ¡ã‚¤ãƒ³æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼

```
[æ±ºæ¸ˆé–‹å§‹] â†’ [ä¾¡æ ¼æƒ…å ±å–å¾—] â†’ [Checkout Sessionä½œæˆ] â†’ [Stripeæ±ºæ¸ˆãƒšãƒ¼ã‚¸] â†’ [æ±ºæ¸ˆå®Œäº†] â†’ [PDFç”Ÿæˆãƒ»é…ä¿¡]
     â†“              â†“                   â†“                    â†“               â†“              â†“
  [ã‚¨ãƒ©ãƒ¼A]      [ã‚¨ãƒ©ãƒ¼B]           [ã‚¨ãƒ©ãƒ¼C]           [ã‚¨ãƒ©ãƒ¼D]      [ã‚¨ãƒ©ãƒ¼E]       [ã‚¨ãƒ©ãƒ¼F]
```

---

## ğŸ“Š ã‚¨ãƒ©ãƒ¼åˆ†é¡ã¨å¯¾å‡¦ãƒ•ãƒ­ãƒ¼

### ã‚¨ãƒ©ãƒ¼A: ä¾¡æ ¼æƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼

```mermaid
flowchart TD
    A[ä¾¡æ ¼æƒ…å ±å–å¾—é–‹å§‹] --> B{APIå¿œç­”ç¢ºèª}
    B -->|æˆåŠŸ| C[ä¾¡æ ¼è¡¨ç¤º]
    B -->|å¤±æ•—| D{ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥åˆ¤å®š}
    
    D -->|ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼| E[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]
    D -->|ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼| F[ã‚µãƒ¼ãƒãƒ¼éšœå®³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]
    D -->|ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ| G[ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]
    
    E --> H[5ç§’å¾Œè‡ªå‹•ãƒªãƒˆãƒ©ã‚¤]
    F --> I[æ‰‹å‹•ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³]
    G --> H
    
    H --> J{ãƒªãƒˆãƒ©ã‚¤å›æ•°ç¢ºèª}
    I --> J
    J -->|3å›æœªæº€| B
    J -->|3å›ä»¥ä¸Š| K[ã‚µãƒãƒ¼ãƒˆé€£çµ¡æ¡ˆå†…]
```

**ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ã€å†åº¦ãŠè©¦ã—ãã ã•ã„"
- ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: "ä¸€æ™‚çš„ãªéšœå®³ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„"
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: "å¿œç­”ã«æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã¾ã™ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„"

### ã‚¨ãƒ©ãƒ¼B: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

```mermaid
flowchart TD
    A[å…¥åŠ›å€¤æ¤œè¨¼] --> B{å¿…é ˆé …ç›®ç¢ºèª}
    B -->|OK| C{å½¢å¼ç¢ºèª}
    B -->|NG| D[å¿…é ˆé …ç›®ã‚¨ãƒ©ãƒ¼è¡¨ç¤º]
    
    C -->|OK| E{ãƒ—ãƒ©ãƒ³æœ‰åŠ¹æ€§ç¢ºèª}
    C -->|NG| F[å½¢å¼ã‚¨ãƒ©ãƒ¼è¡¨ç¤º]
    
    E -->|OK| G[æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸]
    E -->|NG| H[ãƒ—ãƒ©ãƒ³é¸æŠã‚¨ãƒ©ãƒ¼è¡¨ç¤º]
    
    D --> I[è©²å½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ]
    F --> I
    H --> I
    
    I --> J[å…·ä½“çš„ãªä¿®æ­£æ–¹æ³•ã‚’æ¡ˆå†…]
    J --> K[ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿®æ­£å¾…ã¡]
    K --> A
```

**å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹**:
```typescript
const validationErrors = {
  pdf_id: "PDFã‚’é¸æŠã—ã¦ãã ã•ã„",
  plan: "ä¾¡æ ¼ãƒ—ãƒ©ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„", 
  success_url: "æœ‰åŠ¹ãªURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
  email: "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
};
```

### ã‚¨ãƒ©ãƒ¼C: Checkout Sessionä½œæˆã‚¨ãƒ©ãƒ¼

```mermaid
flowchart TD
    A[Sessionä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ] --> B{Stripe APIå¿œç­”}
    B -->|æˆåŠŸ| C[æ±ºæ¸ˆãƒšãƒ¼ã‚¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ]
    B -->|å¤±æ•—| D{ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰åˆ¤å®š}
    
    D -->|authentication_required| E[èªè¨¼ã‚¨ãƒ©ãƒ¼å‡¦ç†]
    D -->|rate_limit_error| F[ãƒ¬ãƒ¼ãƒˆåˆ¶é™å‡¦ç†]
    D -->|api_error| G[APIéšœå®³å‡¦ç†]
    D -->|invalid_request_error| H[ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼å‡¦ç†]
    
    E --> I[ãƒ­ã‚°ã‚¤ãƒ³ä¿ƒé€²]
    F --> J[60ç§’å¾…æ©Ÿå¾Œãƒªãƒˆãƒ©ã‚¤]
    G --> K[éšœå®³é€šçŸ¥ãƒ»æ‰‹å‹•ãƒªãƒˆãƒ©ã‚¤]
    H --> L[å…¥åŠ›å€¤å†ç¢ºèªä¿ƒé€²]
    
    I --> M[ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…ã¡]
    J --> A
    K --> N[ã‚µãƒãƒ¼ãƒˆé€£çµ¡æ¡ˆå†…]
    L --> O[ãƒ•ã‚©ãƒ¼ãƒ ä¿®æ­£æ¡ˆå†…]
```

### ã‚¨ãƒ©ãƒ¼D: æ±ºæ¸ˆå‡¦ç†ã‚¨ãƒ©ãƒ¼ï¼ˆStripeå´ï¼‰

```mermaid
flowchart TD
    A[Stripeæ±ºæ¸ˆãƒšãƒ¼ã‚¸] --> B{æ±ºæ¸ˆå®Ÿè¡Œ}
    B -->|æˆåŠŸ| C[æ±ºæ¸ˆå®Œäº†]
    B -->|å¤±æ•—| D{Stripeã‚¨ãƒ©ãƒ¼ç¨®åˆ¥}
    
    D -->|card_declined| E[ã‚«ãƒ¼ãƒ‰æ‹’å¦å‡¦ç†]
    D -->|insufficient_funds| F[æ®‹é«˜ä¸è¶³å‡¦ç†] 
    D -->|expired_card| G[ã‚«ãƒ¼ãƒ‰æœŸé™åˆ‡ã‚Œå‡¦ç†]
    D -->|incorrect_cvc| H[CVCä¸æ­£å‡¦ç†]
    D -->|processing_error| I[å‡¦ç†ã‚¨ãƒ©ãƒ¼å‡¦ç†]
    
    E --> J[åˆ¥ã‚«ãƒ¼ãƒ‰ä½¿ç”¨æ¡ˆå†…]
    F --> K[æ®‹é«˜ç¢ºèªãƒ»åˆ¥ã‚«ãƒ¼ãƒ‰æ¡ˆå†…]
    G --> L[æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ç™»éŒ²æ¡ˆå†…]
    H --> M[æ­£ã—ã„CVCå…¥åŠ›æ¡ˆå†…]
    I --> N[æ™‚é–“ã‚’ãŠã„ã¦å†è©¦è¡Œæ¡ˆå†…]
    
    J --> O[æ±ºæ¸ˆãƒšãƒ¼ã‚¸ã§å†è©¦è¡Œ]
    K --> O
    L --> O
    M --> O
    N --> P[5åˆ†å¾Œè‡ªå‹•ãƒªãƒˆãƒ©ã‚¤]
    
    P --> Q{ãƒªãƒˆãƒ©ã‚¤å›æ•°ç¢ºèª}
    Q -->|2å›æœªæº€| A
    Q -->|2å›ä»¥ä¸Š| R[ã‚µãƒãƒ¼ãƒˆé€£çµ¡æ¡ˆå†…]
```

**æ±ºæ¸ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹**:
```typescript
const stripeErrorMessages = {
  card_declined: {
    title: "ã‚«ãƒ¼ãƒ‰ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã§ã—ãŸ",
    message: "ãŠä½¿ã„ã®ã‚«ãƒ¼ãƒ‰ã§æ±ºæ¸ˆãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚åˆ¥ã®ã‚«ãƒ¼ãƒ‰ã‚’ãŠè©¦ã—ã„ãŸã ãã‹ã€ã‚«ãƒ¼ãƒ‰ä¼šç¤¾ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚",
    actions: ["åˆ¥ã®ã‚«ãƒ¼ãƒ‰ã‚’è©¦ã™", "ã‚«ãƒ¼ãƒ‰ä¼šç¤¾ã«é€£çµ¡", "ã‚µãƒãƒ¼ãƒˆã«é€£çµ¡"]
  },
  insufficient_funds: {
    title: "æ®‹é«˜ä¸è¶³ã§ã™", 
    message: "ã‚«ãƒ¼ãƒ‰ã®åˆ©ç”¨é™åº¦é¡ã‚’è¶…ãˆã¦ã„ã‚‹ã‹ã€æ®‹é«˜ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚",
    actions: ["æ®‹é«˜ã‚’ç¢ºèª", "åˆ¥ã®ã‚«ãƒ¼ãƒ‰ã‚’è©¦ã™", "åˆ©ç”¨é™åº¦é¡ã‚’ç¢ºèª"]
  }
};
```

### ã‚¨ãƒ©ãƒ¼E: æ±ºæ¸ˆå®Œäº†å¾Œã®Webhookã‚¨ãƒ©ãƒ¼

```mermaid
flowchart TD
    A[æ±ºæ¸ˆå®Œäº†é€šçŸ¥å—ä¿¡] --> B{Webhookç½²åæ¤œè¨¼}
    B -->|æˆåŠŸ| C{æ±ºæ¸ˆçŠ¶æ…‹ç¢ºèª}
    B -->|å¤±æ•—| D[ç½²åã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²]
    
    C -->|completed| E[PDFä½¿ç”¨æ¨©ä»˜ä¸]
    C -->|failed| F[æ±ºæ¸ˆå¤±æ•—å‡¦ç†]
    C -->|processing| G[å‡¦ç†ä¸­çŠ¶æ…‹ç¶­æŒ]
    
    D --> H[æ‰‹å‹•ç¢ºèªãƒ•ãƒ©ã‚°è¨­å®š]
    F --> I[è¿”é‡‘å‡¦ç†é–‹å§‹]
    G --> J[5åˆ†å¾Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å†ç¢ºèª]
    
    E --> K{PDFä½¿ç”¨æ¨©ä»˜ä¸æˆåŠŸ?}
    K -->|æˆåŠŸ| L[ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥é€ä¿¡]
    K -->|å¤±æ•—| M[ä½¿ç”¨æ¨©ä»˜ä¸ãƒªãƒˆãƒ©ã‚¤]
    
    H --> N[ç®¡ç†è€…é€šçŸ¥]
    I --> O[ãƒ¦ãƒ¼ã‚¶ãƒ¼è¿”é‡‘é€šçŸ¥]
    M --> P{ãƒªãƒˆãƒ©ã‚¤å›æ•°ç¢ºèª}
    
    P -->|3å›æœªæº€| E
    P -->|3å›ä»¥ä¸Š| Q[æ‰‹å‹•å¯¾å¿œãƒ•ãƒ©ã‚°]
```

### ã‚¨ãƒ©ãƒ¼F: PDFç”Ÿæˆãƒ»é…ä¿¡ã‚¨ãƒ©ãƒ¼

```mermaid
flowchart TD
    A[PDFç”Ÿæˆé–‹å§‹] --> B{AIç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹å¿œç­”}
    B -->|æˆåŠŸ| C[PDFå“è³ªç¢ºèª]
    B -->|å¤±æ•—| D{ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥åˆ¤å®š}
    
    C -->|å“è³ªOK| E[PDFé…ä¿¡]
    C -->|å“è³ªNG| F[å“è³ªæ”¹å–„ãƒªãƒˆãƒ©ã‚¤]
    
    D -->|AIæœåŠ¡è¶…æ—¶| G[ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†]
    D -->|AIé…é¢ä¸è¶³| H[é…é¡ä¸è¶³å‡¦ç†]
    D -->|ãƒ‡ãƒ¼ã‚¿ä¸æ­£| I[ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼å‡¦ç†]
    
    E --> J{é…ä¿¡æˆåŠŸ?}
    J -->|æˆåŠŸ| K[å®Œäº†é€šçŸ¥]
    J -->|å¤±æ•—| L[é…ä¿¡ãƒªãƒˆãƒ©ã‚¤]
    
    F --> M{ãƒªãƒˆãƒ©ã‚¤å›æ•°ç¢ºèª}
    M -->|2å›æœªæº€| A
    M -->|2å›ä»¥ä¸Š| N[æ‰‹å‹•å“è³ªç¢ºèª]
    
    G --> O[30ç§’å¾Œãƒªãƒˆãƒ©ã‚¤]
    H --> P[ä»£æ›¿AIé¸æŠ]
    I --> Q[å…¥åŠ›ãƒ‡ãƒ¼ã‚¿å†ç¢ºèª]
    
    L --> R{é…ä¿¡ãƒªãƒˆãƒ©ã‚¤å›æ•°}
    R -->|3å›æœªæº€| E
    R -->|3å›ä»¥ä¸Š| S[æ‰‹å‹•é…ä¿¡å¯¾å¿œ]
```

---

## ğŸš¨ ç·Šæ€¥æ™‚å¯¾å¿œãƒ•ãƒ­ãƒ¼

### ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“éšœå®³

```mermaid
flowchart TD
    A[ã‚µãƒ¼ãƒ“ã‚¹éšœå®³æ¤œçŸ¥] --> B[éšœå®³ãƒ¬ãƒ™ãƒ«åˆ¤å®š]
    B -->|Level 1: è»½å¾®| C[è‡ªå‹•å¾©æ—§è©¦è¡Œ]
    B -->|Level 2: ä¸­ç¨‹åº¦| D[æ‰‹å‹•å¾©æ—§ + ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥]
    B -->|Level 3: é‡å¤§| E[ç·Šæ€¥å¯¾å¿œãƒãƒ¼ãƒ æ‹›é›†]
    
    C --> F{å¾©æ—§æˆåŠŸ?}
    F -->|YES| G[ç›£è¦–ç¶™ç¶š]
    F -->|NO| D
    
    D --> H[ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é€šçŸ¥]
    E --> I[å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·Šæ€¥é€šçŸ¥]
    
    H --> J[å¾©æ—§ä½œæ¥­å®Ÿè¡Œ]
    I --> K[ç·Šæ€¥å¾©æ—§ä½œæ¥­]
    
    J --> L[å¾©æ—§ç¢ºèªãƒ†ã‚¹ãƒˆ]
    K --> L
    
    L --> M{ã‚µãƒ¼ãƒ“ã‚¹æ­£å¸¸åŒ–?}
    M -->|YES| N[å¾©æ—§å®Œäº†é€šçŸ¥]
    M -->|NO| O[ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³]
```

### æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ éšœå®³

```mermaid
flowchart TD
    A[æ±ºæ¸ˆéšœå®³æ¤œçŸ¥] --> B[Stripe Dashboardç¢ºèª]
    B -->|Stripeæ­£å¸¸| C[è‡ªç¤¾ã‚·ã‚¹ãƒ†ãƒ ç¢ºèª]
    B -->|Stripeéšœå®³| D[StripeçŠ¶æ³ç›£è¦–]
    
    C --> E{è‡ªç¤¾éšœå®³ãƒ¬ãƒ™ãƒ«}
    E -->|APIéšœå®³| F[APIã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•]
    E -->|DBéšœå®³| G[DBå¾©æ—§ä½œæ¥­]
    E -->|ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³| H[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª]
    
    D --> I[ä»£æ›¿æ±ºæ¸ˆæ‰‹æ®µæ¤œè¨]
    F --> J[å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ]
    G --> J
    H --> J
    
    I --> K[ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ä»£æ›¿æ¡ˆå†…]
    J --> L{å¾©æ—§ç¢ºèª}
    L -->|æˆåŠŸ| M[æ±ºæ¸ˆå†é–‹é€šçŸ¥]
    L -->|å¤±æ•—| N[ä¸Šä½ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³]
```

---

## ğŸ“± ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ã‚¬ã‚¤ãƒ‰

### ã‚¨ãƒ©ãƒ¼UIè¨­è¨ˆæ–¹é‡

1. **åˆ†ã‹ã‚Šã‚„ã™ã•å„ªå…ˆ**
   - æŠ€è¡“ç”¨èªã‚’é¿ã‘ã‚‹
   - å…·ä½“çš„ãªå¯¾å‡¦æ³•ã‚’æç¤º
   - æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ˜ç¢ºã«

2. **è¦ªåˆ‡ãªæ¡ˆå†…**
   - è¬ç½ªã®æ°—æŒã¡ã‚’è¡¨ç¾
   - ä»£æ›¿æ‰‹æ®µã‚’æç¤º
   - ã‚µãƒãƒ¼ãƒˆé€£çµ¡å…ˆã‚’æ˜è¨˜

3. **è¦–è¦šçš„é…æ…®**
   - ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸè‰²åˆ†ã‘
   - ã‚¢ã‚¤ã‚³ãƒ³ã§ç›´æ„Ÿçš„ã«ç†è§£
   - é€²æ—çŠ¶æ³ã®å¯è¦–åŒ–

### ã‚¨ãƒ©ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾‹

```typescript
interface ErrorDisplayProps {
  type: 'warning' | 'error' | 'info';
  title: string;
  message: string;
  actions?: Array<{
    label: string;
    onClick: () => void;
    primary?: boolean;
  }>;
  supportContact?: boolean;
}

const ErrorDisplay: React.FC<ErrorDisplayProps> = ({
  type, title, message, actions, supportContact
}) => {
  return (
    <div className={`error-display error-${type}`}>
      <div className="error-icon">
        {type === 'error' && <ErrorIcon />}
        {type === 'warning' && <WarningIcon />}
        {type === 'info' && <InfoIcon />}
      </div>
      
      <div className="error-content">
        <h3 className="error-title">{title}</h3>
        <p className="error-message">{message}</p>
        
        {actions && (
          <div className="error-actions">
            {actions.map((action, index) => (
              <button
                key={index}
                onClick={action.onClick}
                className={`btn ${action.primary ? 'btn-primary' : 'btn-secondary'}`}
              >
                {action.label}
              </button>
            ))}
          </div>
        )}
        
        {supportContact && (
          <div className="error-support">
            <p>ãŠå›°ã‚Šã®å ´åˆã¯<a href="/support">ã‚µãƒãƒ¼ãƒˆ</a>ã¾ã§ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
          </div>
        )}
      </div>
    </div>
  );
};
```

### è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤å®Ÿè£…ä¾‹

```typescript
class PaymentRetryManager {
  private maxRetries = 3;
  private retryDelay = 1000; // 1ç§’
  
  async executeWithRetry<T>(
    operation: () => Promise<T>,
    errorHandler?: (error: Error, attempt: number) => void
  ): Promise<T> {
    let lastError: Error;
    
    for (let attempt = 1; attempt <= this.maxRetries; attempt++) {
      try {
        return await operation();
      } catch (error) {
        lastError = error as Error;
        
        if (errorHandler) {
          errorHandler(lastError, attempt);
        }
        
        if (attempt < this.maxRetries) {
          await this.delay(this.retryDelay * attempt);
        }
      }
    }
    
    throw lastError!;
  }
  
  private delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}
```

---

## ğŸ“Š ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ»åˆ†æ

### ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹

1. **ã‚¨ãƒ©ãƒ¼ç‡**
   - æ±ºæ¸ˆæˆåŠŸç‡: ç›®æ¨™ 99.5%ä»¥ä¸Š
   - APIå¿œç­”ç‡: ç›®æ¨™ 99.9%ä»¥ä¸Š
   - PDFç”ŸæˆæˆåŠŸç‡: ç›®æ¨™ 99.8%ä»¥ä¸Š

2. **ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**
   - ä¾¡æ ¼å–å¾—: 100msä»¥ä¸‹
   - Sessionä½œæˆ: 500msä»¥ä¸‹
   - PDFç”Ÿæˆ: 30ç§’ä»¥ä¸‹

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**
   - é›¢è„±ç‡: 5%ä»¥ä¸‹
   - å†è©¦è¡Œç‡: 80%ä»¥ä¸Š
   - ã‚µãƒãƒ¼ãƒˆå•ã„åˆã‚ã›ç‡: 1%ä»¥ä¸‹

### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

```yaml
alerts:
  payment_success_rate:
    threshold: 95%
    window: 5m
    action: immediate_notification
    
  api_error_rate:
    threshold: 1%
    window: 1m
    action: warning_notification
    
  pdf_generation_timeout:
    threshold: 30s
    window: 1m
    action: investigation_required
```

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒ¬ãƒ™ãƒ«1: è‡ªå‹•å¯¾å¿œ
- è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
- ä»£æ›¿æ‰‹æ®µã®æç¤º
- FAQæ¡ˆå†…

### ãƒ¬ãƒ™ãƒ«2: ã‚µãƒãƒ¼ãƒˆå¯¾å¿œ
- ãƒãƒ£ãƒƒãƒˆã‚µãƒãƒ¼ãƒˆ
- ãƒ¡ãƒ¼ãƒ«ã‚µãƒãƒ¼ãƒˆ
- é›»è©±ã‚µãƒãƒ¼ãƒˆï¼ˆç·Šæ€¥æ™‚ï¼‰

### ãƒ¬ãƒ™ãƒ«3: æŠ€è¡“ãƒãƒ¼ãƒ å¯¾å¿œ
- ã‚·ã‚¹ãƒ†ãƒ éšœå®³
- ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ

### ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºæº–

```typescript
const escalationRules = {
  level1: {
    conditions: ['standard_error', 'retry_possible'],
    response: 'automated_recovery'
  },
  level2: {
    conditions: ['user_frustration', 'multiple_failures'],
    response: 'human_support'
  },
  level3: {
    conditions: ['system_wide_impact', 'security_concern'],
    response: 'technical_team'
  }
};
```

---

**æœ€çµ‚æ›´æ–°**: 2025-06-20  
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼**: 2025-06-27  
**æ‰¿èªè€…**: ãƒãƒ¼ãƒ Aãƒªãƒ¼ãƒ€ãƒ¼